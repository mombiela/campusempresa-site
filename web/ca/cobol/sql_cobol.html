<!DOCTYPE html>
<html lang="ca">
<head>
	<meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Uso de SQL en programas COBOL</title>
<meta name="description" content="${meta.getChild("description").text}">
<meta name="author" content="${meta.getChild("author").value}">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="/css/site.css">
<script src="/js/cookie.js?v=1"></script>
<script src="/js/page.js?v=1"></script>
</head>

<body>
	<div id="header" class="container-xxl">
		<div class="row">
			<div class="col-8 p-0">
				<h1 class="m-0 p-0">
					<a href="/index.html"><img src="/img/logo_header.png"></a>
				</h3>
			</div>
			<div class="col-4 p-0 text-end">
				<h2><cite>Aprenent junts, construint la societat d'avui i del demà</cite></h2><br>
			</div>
		</div>
	</div>

	<div class="container-xxl" style="margin-top: -1em;">
		<div class="row">
			<div class="col-12 p-0 m-0 text-end">
					<a href="../es/cobol\sql_cobol.html" onclick="setLang('es'); return false;" title="Castellano">
		Castellano
	</a>
	|
	<b>Català</b>
			</div>
		</div>
	</div>
    <div class="top-bar container-fluid">
    	<div class="container-xxl">
	<div class="row">
		<div class="col">
			<a href="/ca/about.html" title="Sobre nosotros">Sobre nosotros</a>
			<a href="/ca/donate.html" title="Donaciones">Donaciones</a>
			<a href="/ca/contribute.html" title="Contribuir">Contribuir</a>
			<a href="/ca/licence.html" title="Licencia">Licencia</a>
		</div>
	</div>
</div>
    </div>
	
    <div id="main_content" class="container-xxl">
    	<div class="row">
    		<div class="col col-8">
    			


			<p>El uso de SQL en programas COBOL permite integrar sentencias SQL directamente dentro del código COBOL, facilitando la interacción con bases de datos relacionales. Este enfoque, conocido como Embedded SQL (SQL embebido), es esencial para realizar operaciones como consultas, inserciones, actualizaciones y eliminaciones de datos en bases de datos. A continuación, se describen las técnicas y ejemplos para el uso de SQL en programas COBOL.</p>

		    	<h2><a id="index_0"></a>Configuración inicial</h2>
						<p>Para utilizar SQL embebido en COBOL, es necesario incluir la estructura SQL Communication Area (SQLCA) que maneja el estado y los errores de SQL.</p>

		    	<h3><a id="index_1"></a>Incluir SQLCA</h3>
						
				<pre>EXEC SQL INCLUDE SQLCA END-EXEC.</pre>
				<p>En este ejemplo:</p>
<ul>
<li><code>EXEC SQL INCLUDE SQLCA END-EXEC</code> incluye la estructura SQLCA, que es utilizada para manejar errores y condiciones SQL.</li>
</ul>

		    	<h2><a id="index_2"></a>Conexión a la base de datos</h2>
						<p>Para conectarse a una base de datos, se utiliza la sentencia <code>CONNECT</code>.</p>

		    	<h3><a id="index_3"></a>Ejemplo de conexión a la base de datos</h3>
						
				<pre>WORKING-STORAGE SECTION.
01 DB-CONNECTION-INFO.
05 DB-USER PIC X(20) VALUE 'usuario'.
05 DB-PASSWORD PIC X(20) VALUE 'contrase&ntilde;a'.
05 DB-NAME PIC X(20) VALUE 'nombre_db'.

PROCEDURE DIVISION.
Conectar-Base-De-Datos.
EXEC SQL
CONNECT :DB-USER IDENTIFIED BY :DB-PASSWORD
USING :DB-NAME
END-EXEC.

IF SQLCODE &lt;&gt; 0
DISPLAY 'Error conectando a la base de datos: ' SQLCODE.
END-IF.</pre>
				<p>En este ejemplo:</p>
<ul>
<li><code>EXEC SQL CONNECT :DB-USER IDENTIFIED BY :DB-PASSWORD USING :DB-NAME END-EXEC</code> establece la conexión a la base de datos utilizando las credenciales proporcionadas.</li>
<li><code>SQLCODE</code> se verifica para asegurar que la conexión fue exitosa.</li>
</ul>

		    	<h2><a id="index_4"></a>Consultas a la base de datos</h2>
						<p>Para realizar consultas en la base de datos, se utiliza la sentencia <code>SELECT</code> embebida.</p>

		    	<h3><a id="index_5"></a>Ejemplo de consulta a la base de datos</h3>
						
				<pre>WORKING-STORAGE SECTION.
01 CLIENTE-ID PIC 9(5).
01 CLIENTE-NOMBRE PIC X(30).
01 CLIENTE-DIRECCION PIC X(50).

PROCEDURE DIVISION.
Consultar-Base-De-Datos.
EXEC SQL
SELECT CLIENTE_ID, CLIENTE_NOMBRE, CLIENTE_DIRECCION
INTO :CLIENTE-ID, :CLIENTE-NOMBRE, :CLIENTE-DIRECCION
FROM CLIENTES
WHERE CLIENTE_ID = 12345
END-EXEC.

IF SQLCODE = 0
DISPLAY 'Cliente ID: ' CLIENTE-ID.
DISPLAY 'Cliente Nombre: ' CLIENTE-NOMBRE.
DISPLAY 'Cliente Direcci&oacute;n: ' CLIENTE-DIRECCION.
ELSE
DISPLAY 'Error en consulta: ' SQLCODE.
END-IF.</pre>
				<p>En este ejemplo:</p>
<ul>
<li><code>EXEC SQL SELECT CLIENTE_ID, CLIENTE_NOMBRE, CLIENTE_DIRECCION INTO :CLIENTE-ID, :CLIENTE-NOMBRE, :CLIENTE-DIRECCION FROM CLIENTES WHERE CLIENTE_ID = 12345 END-EXEC</code> ejecuta una consulta SQL que selecciona los datos del cliente con <code>CLIENTE_ID</code> igual a 12345.</li>
<li>Los resultados se almacenan en las variables definidas en la sección <code>WORKING-STORAGE</code>.</li>
</ul>

		    	<h2><a id="index_6"></a>Inserción de datos en la base de datos</h2>
						<p>Para insertar nuevos registros en la base de datos, se utiliza la sentencia <code>INSERT</code>.</p>

		    	<h3><a id="index_7"></a>Ejemplo de inserción de datos</h3>
						
				<pre>PROCEDURE DIVISION.
Insertar-En-Base-De-Datos.
EXEC SQL
INSERT INTO CLIENTES (CLIENTE_ID, CLIENTE_NOMBRE, CLIENTE_DIRECCION)
VALUES (:CLIENTE-ID, :CLIENTE-NOMBRE, :CLIENTE-DIRECCION)
END-EXEC.

IF SQLCODE &lt;&gt; 0
DISPLAY 'Error insertando datos: ' SQLCODE.
ELSE
DISPLAY 'Datos insertados correctamente'.
END-IF.</pre>
				<p>En este ejemplo:</p>
<ul>
<li><code>EXEC SQL INSERT INTO CLIENTES (CLIENTE_ID, CLIENTE_NOMBRE, CLIENTE_DIRECCION) VALUES (:CLIENTE-ID, :CLIENTE-NOMBRE, :CLIENTE-DIRECCION) END-EXEC</code> inserta un nuevo registro en la tabla CLIENTES.</li>
<li><code>SQLCODE</code> se verifica para asegurar que la inserción fue exitosa.</li>
</ul>

		    	<h2><a id="index_8"></a>Actualización de datos en la base de datos</h2>
						<p>Para actualizar registros existentes, se utiliza la sentencia <code>UPDATE</code>.</p>

		    	<h3><a id="index_9"></a>Ejemplo de actualización de datos</h3>
						
				<pre>PROCEDURE DIVISION.
Actualizar-En-Base-De-Datos.
EXEC SQL
UPDATE CLIENTES
SET CLIENTE_DIRECCION = :CLIENTE-DIRECCION
WHERE CLIENTE_ID = :CLIENTE-ID
END-EXEC.

IF SQLCODE &lt;&gt; 0
DISPLAY 'Error actualizando datos: ' SQLCODE.
ELSE
DISPLAY 'Datos actualizados correctamente'.
END-IF.</pre>
				<p>En este ejemplo:</p>
<ul>
<li><code>EXEC SQL UPDATE CLIENTES SET CLIENTE_DIRECCION = :CLIENTE-DIRECCION WHERE CLIENTE_ID = :CLIENTE-ID END-EXEC</code> actualiza la dirección del cliente con el ID especificado.</li>
<li><code>SQLCODE</code> se verifica para asegurar que la actualización fue exitosa.</li>
</ul>

		    	<h2><a id="index_10"></a>Eliminación de datos en la base de datos</h2>
						<p>Para eliminar registros, se utiliza la sentencia <code>DELETE</code>.</p>

		    	<h3><a id="index_11"></a>Ejemplo de eliminación de datos</h3>
						
				<pre>PROCEDURE DIVISION.
Eliminar-En-Base-De-Datos.
EXEC SQL
DELETE FROM CLIENTES
WHERE CLIENTE_ID = :CLIENTE-ID
END-EXEC.

IF SQLCODE &lt;&gt; 0
DISPLAY 'Error eliminando datos: ' SQLCODE.
ELSE
DISPLAY 'Datos eliminados correctamente'.
END-IF.</pre>
				<p>En este ejemplo:</p>
<ul>
<li><code>EXEC SQL DELETE FROM CLIENTES WHERE CLIENTE_ID = :CLIENTE-ID END-EXEC</code> elimina el registro del cliente con el ID especificado.</li>
<li><code>SQLCODE</code> se verifica para asegurar que la eliminación fue exitosa.</li>
</ul>

		    	<h2><a id="index_12"></a>Manejo de errores y excepciones</h2>
						<p>El manejo de errores en operaciones con bases de datos se realiza mediante la verificación del <code>SQLCODE</code> y el uso de la estructura <code>SQLCA</code>.</p>

		    	<h3><a id="index_13"></a>Ejemplo de manejo de errores</h3>
						
				<pre>WORKING-STORAGE SECTION.
EXEC SQL INCLUDE SQLCA END-EXEC.

PROCEDURE DIVISION.
Conectar-Base-De-Datos.
EXEC SQL
CONNECT :DB-USER IDENTIFIED BY :DB-PASSWORD
USING :DB-NAME
END-EXEC.

IF SQLCODE &lt;&gt; 0
DISPLAY 'Error conectando a la base de datos: ' SQLCODE.
DISPLAY SQLERRMC.
END-IF.</pre>
				<p>En este ejemplo:</p>
<ul>
<li><code>SQLCODE</code> y <code>SQLERRMC</code> se utilizan para verificar y mostrar mensajes de error en operaciones de base de datos.</li>
</ul>

		    	<h2><a id="index_14"></a>Desconexión de la base de datos</h2>
						<p>Para desconectar de la base de datos, se utiliza la sentencia <code>DISCONNECT</code>.</p>

		    	<h3><a id="index_15"></a>Ejemplo de desconexión de la base de datos</h3>
						
				<pre>PROCEDURE DIVISION.
Desconectar-Base-De-Datos.
EXEC SQL
DISCONNECT
END-EXEC.

IF SQLCODE &lt;&gt; 0
DISPLAY 'Error desconectando de la base de datos: ' SQLCODE.
ELSE
DISPLAY 'Desconectado correctamente de la base de datos'.
END-IF.</pre>
				<p>En este ejemplo:</p>
<ul>
<li><code>EXEC SQL DISCONNECT END-EXEC</code> desconecta la</li>
</ul>
<p>sesión de la base de datos.</p>
<ul>
<li><code>SQLCODE</code> se verifica para asegurar que la desconexión fue exitosa.</li>
</ul>

		    	<h2><a id="index_16"></a>Conclusión</h2>
						<p>El uso de SQL en programas COBOL mediante Embedded SQL permite la integración eficiente con bases de datos relacionales. Comprender cómo realizar conexiones, consultas, inserciones, actualizaciones, eliminaciones y manejar errores es esencial para desarrollar aplicaciones COBOL robustas y eficientes que interactúen con bases de datos modernas.</p>

	
<!--
<div class="row">
	<div class="col-4" style="margin-bottom: 1rem;">
		<div class="card">
		  <div class="card-body" style="background-color:#eee">
		    <h3 class="card-title" >Card title</h3>
		  </div>
		  <ul class="list-group list-group-flush">
		    <li class="list-group-item">An item</li>
		    <li class="list-group-item">A second item</li>
		    <li class="list-group-item">A third item</li>
		  </ul>
		  <div class="card-body">
		    <a href="#" class="card-link">Card link</a>
		    <a href="#" class="card-link">Another link</a>
		  </div>
		</div>
	</div>
	<div class="col-4">
		<div class="card">
		  <div class="card-body" style="background-color:#eee">
		    <h3 class="card-title" >Card title</h3>
		  </div>
		  <ul class="list-group list-group-flush">
		    <li class="list-group-item">An item</li>
		    <li class="list-group-item">A second item</li>
		    <li class="list-group-item">A third item</li>
		  </ul>
		  <div class="card-body">
		    <a href="#" class="card-link">Card link</a>
		    <a href="#" class="card-link">Another link</a>
		  </div>
		</div>
	</div>
	<div class="col-4">
		<div class="card">
		  <div class="card-body" style="background-color:#eee">
		    <h3 class="card-title" >Card title</h3>
		  </div>
		  <ul class="list-group list-group-flush">
		    <li class="list-group-item">An item</li>
		    <li class="list-group-item">A second item</li>
		    <li class="list-group-item">A third item</li>
		  </ul>
		  <div class="card-body">
		    <a href="#" class="card-link">Card link</a>
		    <a href="#" class="card-link">Another link</a>
		  </div>
		</div>
	</div>
	<div class="col-4">
			<div class="card">
			<a href="react/">
				  <div class="card-body" style="background-color:#eee">
				    <h3 class="card-title" >Frameworks y tecnologías</h3>
				  </div>
				  <div class="card-body">
				  	<p>Te enseñamos las tecnologías más actuales en Frameworks</p>
				  </div>
			 </a>
			</div>
	</div>
</div>
-->
    		</div>
    		<div class="col col-4">
    			<h2>Patrocinadors</h2>
<p>Vols ser el nostre patrocinador? De moment no tenim patrocinadors oficials, però estem oberts a propostes.</p>
<p>Vols ser un d'ells? Contacta amb nosaltres:</p>
<p><a href="mailto:admin@campusempresa.com">admin@campusempresa.com</a></p>
<p>Aquest serà el teu espai reservat :-)</p>
    	
<div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- STxT - Adaptable -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="5037052041"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
    		</div>
    	</div>
	</div>
	
    <div class="container-xxl mt-3">
		<div class="row">
			<div class="col">
				<footer><p>&copy; 2024 - Tots els drets reservats.</p></footer>
			</div>
		</div>
	</div>	
	
	<div id="cookies_adv">
		Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
        <a href="javascript:accept();" class="button">Entès!</a>
        <a href="cookies.html">Més informació</a>
    </div>
    <script>checkCookies();</script>
</body>
</html>
