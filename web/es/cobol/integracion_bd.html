<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Integración de bases de datos en aplicaciones COBOL</title>
<meta name="description" content="${meta.getChild("description").text}">
<meta name="author" content="${meta.getChild("author").value}">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="/css/site.css">
<script src="/js/cookie.js?v=1"></script>
<script src="/js/page.js?v=1"></script>
</head>

<body>
	<div id="header" class="container-xxl">
		<div class="row">
			<div class="col-8 p-0">
				<h1 class="m-0 p-0">
					<a href="/index.html"><img src="/img/logo_header.png"></a>
				</h3>
			</div>
			<div class="col-4 p-0 text-end">
				<h2><cite>Aprendiendo juntos, construyendo la sociedad de hoy y del mañana</cite></h2><br>
			</div>
		</div>
	</div>

	<div class="container-xxl" style="margin-top: -1em;">
		<div class="row">
			<div class="col-12 p-0 m-0 text-end">
					<b>Castellano</b>
	|
	<a href="../ca/cobol\integracion_bd.html" onclick="setLang('ca'); return false;"  title="Castellano">
		Català
	</a>
			</div>
		</div>
	</div>
    <div class="top-bar container-fluid">
    	<div class="container-xxl">
	<div class="row">
		<div class="col">
			<a href="/es/about.html" title="Sobre nosotros">Sobre nosotros</a>
			<a href="/es/donate.html" title="Donaciones">Donaciones</a>
			<a href="/es/contribute.html" title="Contribuir">Contribuir</a>
			<a href="/es/licence.html" title="Licencia">Licencia</a>
		</div>
	</div>
</div>
    </div>
	
    <div id="main_content" class="container-xxl">
    	<div class="row">
    		<div class="col col-8">
    			


			<p>La integración de bases de datos en aplicaciones COBOL es una práctica esencial para aprovechar las capacidades de almacenamiento y manipulación de datos de los sistemas de gestión de bases de datos relacionales (RDBMS). Esta integración se logra mediante el uso de Embedded SQL (SQL embebido) dentro del código COBOL. A continuación, se describen los pasos y las técnicas necesarias para integrar bases de datos en aplicaciones COBOL de manera efectiva.</p>

		    	<h2><a id="index_0"></a>Configuración inicial</h2>
						<p>Para comenzar a utilizar SQL embebido en COBOL, es necesario incluir la estructura SQL Communication Area (SQLCA) que maneja el estado y los errores de SQL.</p>

		    	<h3><a id="index_1"></a>Incluir SQLCA</h3>
						
				<pre>EXEC SQL INCLUDE SQLCA END-EXEC.</pre>
				<p>En este ejemplo:</p>
<ul>
<li><code>EXEC SQL INCLUDE SQLCA END-EXEC</code> incluye la estructura SQLCA, que es utilizada para manejar errores y condiciones SQL.</li>
</ul>

		    	<h2><a id="index_2"></a>Conexión a la base de datos</h2>
						<p>La conexión a una base de datos se establece mediante la sentencia <code>CONNECT</code>. Es crucial manejar correctamente las credenciales y la información de conexión.</p>

		    	<h3><a id="index_3"></a>Ejemplo de conexión a la base de datos</h3>
						
				<pre>WORKING-STORAGE SECTION.
01 DB-CONNECTION-INFO.
05 DB-USER PIC X(20) VALUE 'usuario'.
05 DB-PASSWORD PIC X(20) VALUE 'contrase&ntilde;a'.
05 DB-NAME PIC X(20) VALUE 'nombre_db'.

PROCEDURE DIVISION.
Conectar-Base-De-Datos.
EXEC SQL
CONNECT :DB-USER IDENTIFIED BY :DB-PASSWORD
USING :DB-NAME
END-EXEC.

IF SQLCODE &lt;&gt; 0
DISPLAY 'Error conectando a la base de datos: ' SQLCODE.
END-IF.</pre>
				<p>En este ejemplo:</p>
<ul>
<li><code>EXEC SQL CONNECT :DB-USER IDENTIFIED BY :DB-PASSWORD USING :DB-NAME END-EXEC</code> establece la conexión a la base de datos utilizando las credenciales proporcionadas.</li>
<li><code>SQLCODE</code> se verifica para asegurar que la conexión fue exitosa.</li>
</ul>

		    	<h2><a id="index_4"></a>Operaciones básicas de SQL</h2>
						<p>Las operaciones básicas de SQL, como SELECT, INSERT, UPDATE y DELETE, se utilizan para interactuar con la base de datos.</p>

		    	<h3><a id="index_5"></a>Ejemplo de consulta (SELECT)</h3>
						
				<pre>WORKING-STORAGE SECTION.
01 CLIENTE-ID PIC 9(5).
01 CLIENTE-NOMBRE PIC X(30).
01 CLIENTE-DIRECCION PIC X(50).

PROCEDURE DIVISION.
Consultar-Base-De-Datos.
EXEC SQL
SELECT CLIENTE_ID, CLIENTE_NOMBRE, CLIENTE_DIRECCION
INTO :CLIENTE-ID, :CLIENTE-NOMBRE, :CLIENTE-DIRECCION
FROM CLIENTES
WHERE CLIENTE_ID = 12345
END-EXEC.

IF SQLCODE = 0
DISPLAY 'Cliente ID: ' CLIENTE-ID.
DISPLAY 'Cliente Nombre: ' CLIENTE-NOMBRE.
DISPLAY 'Cliente Direcci&oacute;n: ' CLIENTE-DIRECCION.
ELSE
DISPLAY 'Error en consulta: ' SQLCODE.
END-IF.</pre>
				<p>En este ejemplo:</p>
<ul>
<li><code>EXEC SQL SELECT CLIENTE_ID, CLIENTE_NOMBRE, CLIENTE_DIRECCION INTO :CLIENTE-ID, :CLIENTE-NOMBRE, :CLIENTE-DIRECCION FROM CLIENTES WHERE CLIENTE_ID = 12345 END-EXEC</code> ejecuta una consulta SQL para obtener los datos de un cliente específico.</li>
</ul>

		    	<h3><a id="index_6"></a>Ejemplo de inserción (INSERT)</h3>
						
				<pre>PROCEDURE DIVISION.
Insertar-En-Base-De-Datos.
EXEC SQL
INSERT INTO CLIENTES (CLIENTE_ID, CLIENTE_NOMBRE, CLIENTE_DIRECCION)
VALUES (:CLIENTE-ID, :CLIENTE-NOMBRE, :CLIENTE-DIRECCION)
END-EXEC.

IF SQLCODE &lt;&gt; 0
DISPLAY 'Error insertando datos: ' SQLCODE.
ELSE
DISPLAY 'Datos insertados correctamente'.
END-IF.</pre>
				<p>En este ejemplo:</p>
<ul>
<li><code>EXEC SQL INSERT INTO CLIENTES (CLIENTE_ID, CLIENTE_NOMBRE, CLIENTE_DIRECCION) VALUES (:CLIENTE-ID, :CLIENTE-NOMBRE, :CLIENTE-DIRECCION) END-EXEC</code> inserta un nuevo registro en la tabla CLIENTES.</li>
</ul>

		    	<h3><a id="index_7"></a>Ejemplo de actualización (UPDATE)</h3>
						
				<pre>PROCEDURE DIVISION.
Actualizar-En-Base-De-Datos.
EXEC SQL
UPDATE CLIENTES
SET CLIENTE_DIRECCION = :CLIENTE-DIRECCION
WHERE CLIENTE_ID = :CLIENTE-ID
END-EXEC.

IF SQLCODE &lt;&gt; 0
DISPLAY 'Error actualizando datos: ' SQLCODE.
ELSE
DISPLAY 'Datos actualizados correctamente'.
END-IF.</pre>
				<p>En este ejemplo:</p>
<ul>
<li><code>EXEC SQL UPDATE CLIENTES SET CLIENTE_DIRECCION = :CLIENTE-DIRECCION WHERE CLIENTE_ID = :CLIENTE-ID END-EXEC</code> actualiza la dirección del cliente con el ID especificado.</li>
</ul>

		    	<h3><a id="index_8"></a>Ejemplo de eliminación (DELETE)</h3>
						
				<pre>PROCEDURE DIVISION.
Eliminar-En-Base-De-Datos.
EXEC SQL
DELETE FROM CLIENTES
WHERE CLIENTE_ID = :CLIENTE-ID
END-EXEC.

IF SQLCODE &lt;&gt; 0
DISPLAY 'Error eliminando datos: ' SQLCODE.
ELSE
DISPLAY 'Datos eliminados correctamente'.
END-IF.</pre>
				<p>En este ejemplo:</p>
<ul>
<li><code>EXEC SQL DELETE FROM CLIENTES WHERE CLIENTE_ID = :CLIENTE-ID END-EXEC</code> elimina el registro del cliente con el ID especificado.</li>
</ul>

		    	<h2><a id="index_9"></a>Manejo de transacciones</h2>
						<p>El manejo de transacciones es crucial para asegurar la integridad de los datos. Las sentencias <code>COMMIT</code> y <code>ROLLBACK</code> se utilizan para manejar transacciones.</p>

		    	<h3><a id="index_10"></a>Ejemplo de manejo de transacciones</h3>
						
				<pre>PROCEDURE DIVISION.
Transaccion-En-Base-De-Datos.
EXEC SQL
UPDATE CLIENTES
SET CLIENTE_DIRECCION = :CLIENTE-DIRECCION
WHERE CLIENTE_ID = :CLIENTE-ID
END-EXEC.

IF SQLCODE = 0
EXEC SQL COMMIT END-EXEC
DISPLAY 'Transacci&oacute;n completada exitosamente'.
ELSE
EXEC SQL ROLLBACK END-EXEC
DISPLAY 'Error en transacci&oacute;n, cambios revertidos: ' SQLCODE.
END-IF.</pre>
				<p>En este ejemplo:</p>
<ul>
<li><code>EXEC SQL COMMIT END-EXEC</code> confirma la transacción si la operación de actualización es exitosa.</li>
<li><code>EXEC SQL ROLLBACK END-EXEC</code> revierte los cambios si ocurre un error.</li>
</ul>

		    	<h2><a id="index_11"></a>Manejo de errores y excepciones</h2>
						<p>Es crucial manejar los errores y excepciones durante las operaciones con bases de datos.</p>

		    	<h3><a id="index_12"></a>Ejemplo de manejo de errores</h3>
						
				<pre>WORKING-STORAGE SECTION.
EXEC SQL INCLUDE SQLCA END-EXEC.

PROCEDURE DIVISION.
Manejar-Errores-SQL.
EXEC SQL
SELECT CLIENTE_ID, CLIENTE_NOMBRE, CLIENTE_DIRECCION
INTO :CLIENTE-ID, :CLIENTE-NOMBRE, :CLIENTE-DIRECCION
FROM CLIENTES
WHERE CLIENTE_ID = 99999
END-EXEC.

IF SQLCODE &lt;&gt; 0
DISPLAY 'Error en consulta: ' SQLCODE ':' SQLERRMC.
ELSE
DISPLAY 'Consulta exitosa: ' CLIENTE-NOMBRE ',' CLIENTE-DIRECCION.
END-IF.</pre>
				<p>En este ejemplo:</p>
<ul>
<li><code>SQLCODE</code> y <code>SQLERRMC</code> se utilizan para verificar y mostrar mensajes de error en operaciones de</li>
</ul>
<p>base de datos.</p>

		    	<h2><a id="index_13"></a>Desconexión de la base de datos</h2>
						<p>Para desconectar de la base de datos, se utiliza la sentencia <code>DISCONNECT</code>.</p>

		    	<h3><a id="index_14"></a>Ejemplo de desconexión de la base de datos</h3>
						
				<pre>PROCEDURE DIVISION.
Desconectar-Base-De-Datos.
EXEC SQL
DISCONNECT
END-EXEC.

IF SQLCODE &lt;&gt; 0
DISPLAY 'Error desconectando de la base de datos: ' SQLCODE.
ELSE
DISPLAY 'Desconectado correctamente de la base de datos'.
END-IF.</pre>
				<p>En este ejemplo:</p>
<ul>
<li><code>EXEC SQL DISCONNECT END-EXEC</code> desconecta la sesión de la base de datos.</li>
<li><code>SQLCODE</code> se verifica para asegurar que la desconexión fue exitosa.</li>
</ul>

		    	<h2><a id="index_15"></a>Conclusión</h2>
						<p>La integración de bases de datos en aplicaciones COBOL mediante Embedded SQL permite una interacción eficiente con sistemas de gestión de bases de datos relacionales. Comprender cómo establecer conexiones, realizar operaciones básicas de SQL, manejar transacciones y errores es esencial para desarrollar aplicaciones COBOL robustas y eficientes.</p>

	
<!--
<div class="row">
	<div class="col-4" style="margin-bottom: 1rem;">
		<div class="card">
		  <div class="card-body" style="background-color:#eee">
		    <h3 class="card-title" >Card title</h3>
		  </div>
		  <ul class="list-group list-group-flush">
		    <li class="list-group-item">An item</li>
		    <li class="list-group-item">A second item</li>
		    <li class="list-group-item">A third item</li>
		  </ul>
		  <div class="card-body">
		    <a href="#" class="card-link">Card link</a>
		    <a href="#" class="card-link">Another link</a>
		  </div>
		</div>
	</div>
	<div class="col-4">
		<div class="card">
		  <div class="card-body" style="background-color:#eee">
		    <h3 class="card-title" >Card title</h3>
		  </div>
		  <ul class="list-group list-group-flush">
		    <li class="list-group-item">An item</li>
		    <li class="list-group-item">A second item</li>
		    <li class="list-group-item">A third item</li>
		  </ul>
		  <div class="card-body">
		    <a href="#" class="card-link">Card link</a>
		    <a href="#" class="card-link">Another link</a>
		  </div>
		</div>
	</div>
	<div class="col-4">
		<div class="card">
		  <div class="card-body" style="background-color:#eee">
		    <h3 class="card-title" >Card title</h3>
		  </div>
		  <ul class="list-group list-group-flush">
		    <li class="list-group-item">An item</li>
		    <li class="list-group-item">A second item</li>
		    <li class="list-group-item">A third item</li>
		  </ul>
		  <div class="card-body">
		    <a href="#" class="card-link">Card link</a>
		    <a href="#" class="card-link">Another link</a>
		  </div>
		</div>
	</div>
	<div class="col-4">
			<div class="card">
			<a href="react/">
				  <div class="card-body" style="background-color:#eee">
				    <h3 class="card-title" >Frameworks y tecnologías</h3>
				  </div>
				  <div class="card-body">
				  	<p>Te enseñamos las tecnologías más actuales en Frameworks</p>
				  </div>
			 </a>
			</div>
	</div>
</div>
-->
    		</div>
    		<div class="col col-4">
    			<h2>Patrocinadores</h2>
<p>¿Quieres ser nuestro patrocinador? De momento no tenemos patrocinadores oficiales, pero estamos abiertos a propuestas.</p>
<p>¿Quieres ser uno de ellos? Contacta con nosotros:</p>
<p><a href="mailto:admin@campusempresa.com">admin@campusempresa.com</a></p>
<p>Este será tu espacio reservado :-)</p>
    	
<div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- STxT - Adaptable -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="5037052041"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
    		</div>
    	</div>
	</div>
	
    <div class="container-xxl mt-3">
		<div class="row">
			<div class="col">
				<footer><p>&copy; 2024 - Todos los derechos reservados.</p></footer>
			</div>
		</div>
	</div>	
	
	<div id="cookies_adv">
		Usamos cookies para mejorar su experiencia de uso y ofrecer contenidos adaptados a sus intereses
        <a href="javascript:accept();" class="button">Entendido!</a>
        <a href="cookies.html">Más información</a>
    </div>
    <script>checkCookies();</script>
</body>
</html>
